<html>
<head>
    <title>Ajax</title>
    <link rel="stylesheet" type="text/css" href="../../extjs-4.0/resources/css/ext-all.css">
    <script type="text/javascript" src="../../extjs-4.0/ext-debug.js"></script>
    <script type="text/javascript" src="../../app.js"></script>
    <script type="text/javascript">
        CONFIG.centerConfig = {
            items: [
                {
                    contentEl: 'contentId'
                },
                {
                    id: 'output',
                    items: {html: '<p>Nothing yet</p>'}
                }
            ]
        };
        Ext.onReady(function() {
            var LE = createApp();
        });

        function output(html) {
            var op = Ext.getCmp('output');
            op.removeAll();
            op.add(Ext.widget('panel', {html: html}));
        }

        /**
         * Runs the given opts which will be supplimented with a default configuration
         * that encodes and outputs the result.
         * @param opts Options for the Ext.Ajax.request() call.
         */
        function run(opts) {
            var defs = {
                url: '/echo',
                success: function(response, opts) {
                    var txt = Ext.htmlEncode(response.responseText);
                    output(Html.p(txt));
                },
                failure: function(response, opts) {
                    var msg = 'server-side failure with status code ' + response.status;
                    output(Html.p(msg));
                }
            };
            var options = Ext.apply(defs, opts);
            Ext.Ajax.request(options);
        }

        function simpleRequest() {
            run();
        }

    </script>
</head>
<body>
<div id="contentId">
    <a href='#' onclick="output('<p>Yay!</p>'); return false;">Smoke Check</a><br/>
    <a href='#' onclick="simpleRequest(); return false;">Simple Request</a><br/>
</div>
</body>
</html>